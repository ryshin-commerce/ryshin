"use strict";function FileUpload(){this.InputElement=null,this.PreviewBoxElement=null,this.CurentImageBox=null,this.Form=null,this.MaxFile=null,this.StoredFiles=[],this.CurentFiles=[],this.CurentPreviewImages=[],this.Extend=function(e,t,i,a,n,l,s,o,r,c,d,u,m,h,f,v,p){this.DefaultCompress=f||75,this.DefaultIsAddLogo=v||!1,this.DefaultDisableProductFeed=p||!1,this.InputElement=l,this.PreviewBoxElement=o,this.CurentImageBox=s,this.Classifications=a||[],this.ClassificationInfo=JSON.parse(n),this.Form=r,this.UniqueControlName=m||"CurentFilePaths[]",this.NewImageObjectControlName=h||"NewFilePaths[]",this.MaxFile=c||2,this.InputChangeCallBack=void 0!==d?d:null,this.InputElement.addEventListener("change",this.InputChange),(this.InputElement.fileUpload=this).FileReader=new FileReader,this.IsCreateInputName=u||!1,this.HostCdn=e||"",this.CurentFiles=t||[],this.CurentPreviewImages=i||[],this.Process()},this.Process=function(){if(this.CurentImageBox)for(var t=this,e=0;e<this.CurentFiles.length;e++){var i=this.CurentFiles[e],a=this.CurentPreviewImages[e].split(">"),n=a[0],l=+a[1],s="True"==a[2],o="True"==a[3],r=t.UniqueControlName.replace("INDEX",e),c=i.substring(i.lastIndexOf("/")+1),d=JSON.parse(this.Classifications[e]),u=document.createElement("div");u.className=" col-3 gutter-10";var m=document.createElement("figure");m.className=" _p-item _max-height-200 relative hover-children-show text-yellow";var h=document.createElement("div");h.className="absolute hide padding tablet-show -border width-100 height-100 _fill-silver-opacity ";var f=(new Date).getTime(),v="<div>Compress:"+l+"<br><input type='number' class='_hidden' data-unique-name="+r+" name='"+r+".CompressNumber' value='"+l+"'"+(t.Form?" form='"+t.Form.id+"'":"")+"></input></div>",p="<div class='row'><input id='chk"+f+"1' value='True' type='checkbox' class='' "+(o?"checked":"")+" data-unique-name="+r+" name='"+r+".IsRemoveProductFeed'"+(t.Form?" form='"+t.Form.id+"'":"")+"></input><label  class='inline-block width-auto  text-yellow' for='chk"+f+"1'>Remove Product Feed</label></div>",C="<div class='row'><input value='True' disabled id='chk"+f+"2' type='checkbox' class='' "+(s?"checked":"")+" data-unique-name="+r+" name='"+r+".IsAddLogo'"+(t.Form?" form='"+t.Form.id+"'":"")+"></input><label class='inline-block width-auto text-yellow' for='chk"+f+"2'>Add Logo</label></div>",F="<input class='_hidden' type='text' class=''  data-unique-name="+r+" name='"+r+".FileName' value='"+c+"' "+(t.Form?" form='"+t.Form.id+"'":"")+"></input>",g="";if(1===this.ClassificationInfo.length)g="<div class='_hidden'><input id='chk"+e+this.ClassificationInfo[0].value+"' value='"+this.ClassificationInfo[0].value+"' type='checkbox' class='' checked data-unique-name="+r+" name='"+r+".Classifications[]'"+(t.Form?" form='"+t.Form.id+"'":"")+"></input><label  class='inline-block width-auto  text-yellow' for='chk"+e+this.ClassificationInfo[0].value+"'>"+this.ClassificationInfo[0].text+"</label></div>";else for(var I=0;I<this.ClassificationInfo.length;I++){var x="";0<=d.indexOf(this.ClassificationInfo[I].value)&&(x="checked"),g+="<div class='col-6 overflow-hidden'><input id='chk"+e+this.ClassificationInfo[I].value+"' value='"+this.ClassificationInfo[I].value+"' type='checkbox' class='' "+x+" data-unique-name="+r+" name='"+r+".Classifications[]'"+(t.Form?" form='"+t.Form.id+"'":"")+"></input><label  class='inline-block width-auto  text-yellow' for='chk"+e+this.ClassificationInfo[I].value+"'>"+this.ClassificationInfo[I].text+"</label></div>"}h.innerHTML=v+p+C+F+"<hr/>"+g;var b=document.createElement("button");b.className="btn text-strong  margin-top _idClickRemove",b.innerText="CLICK ĐỂ XÓA",b.type="button",b.dataset.file=i,b.dataset.notClose="I",b.addEventListener("click",function(e){t.RemoveCurentFile(e,t.InputElement)}),h.append(b);var w="<div data-image-show><img class='_max-width-100-percent' src='"+t.HostCdn+n+"' alt='"+c+"' data-file='"+c+"' /><figcaption class='padding-5 text-center _text-ellipsis'>"+c+"</figcaption></div>";if(t.IsCreateInputName)w+="<input type='text' class='_hidden'  data-unique-name="+r+" name='"+r+".ImageUrl' value="+i+(t.Form?" form='"+t.Form.id+"'":"")+"></input>";w="<div data-image-show>"+w+"</div>",m.innerHTML=w,m.insertBefore(h,m.childNodes[0]),u.appendChild(m),t.CurentImageBox.appendChild(u)}},this.InputChange=function(e){var F=e.target.fileUpload,t=e.target.files,i=Array.prototype.slice.call(t);F.PreviewBoxElement.innerHTML="",F.StoredFiles=[];for(var a=0;a<i.length;a++){var g=i[a];if(!g.type.match("image.*"))return;if(F.StoredFiles.push(g),F.PreviewBoxElement===F.CurentImageBox&&(F.CurentFiles=[],F.CurentImageBox.innerHTML=""),F.StoredFiles.length+F.CurentFiles.length<=F.MaxFile){var n=new FileReader;n.IndexFile=a,n.FileName=g.name,n.onload=function(e,t){var i=F.DefaultCompress,a=F.DefaultIsAddLogo,n=F.DefaultDisableProductFeed,l=F.NewImageObjectControlName.replace("INDEX",e.currentTarget.IndexFile),s=document.createElement("div");s.className=" col-3 gutter-10";var o=document.createElement("figure");o.className=" _p-item _max-height-200 relative hover-children-show";var r=document.createElement("div");r.className="absolute hide padding tablet-show -border width-100 height-100 _fill-silver-opacity ";var c=(new Date).getTime(),d="<div>Index<input type='number' class='s  margin-left _max-width-100' name='"+l+".CompressNumber' value='"+i+"'"+(F.Form?" form='"+F.Form.id+"'":"")+"></input></div>",u="<div class='row'><input  value='True' id='chk"+c+"1' type='checkbox' class='' "+(n?"checked":"")+" name='"+l+".IsRemoveProductFeed'"+(F.Form?" form='"+F.Form.id+"'":"")+"></input><label  class='inline-block width-auto' for='chk"+c+"1'>Remove Product Feed</label></div>",m="<div class='row'><input  value='True'   id='chk"+c+"2' type='checkbox' class='' "+(a?"checked":"")+" name='"+l+".IsAddLogo'"+(F.Form?" form='"+F.Form.id+"'":"")+"></input><label class='inline-block width-auto' for='chk"+c+"2'>Add Logo</label></div>",h="<input class='_hidden' type='text' class='' "+(a?"checked":"")+" name='"+l+".FileName' value='"+e.currentTarget.FileName+"' "+(F.Form?" form='"+F.Form.id+"'":"")+"></input>",f="";if(1===F.ClassificationInfo.length)f="<div class='_hidden'><input id='chkx"+F.ClassificationInfo[0].value+"' value='"+F.ClassificationInfo[0].value+"' type='checkbox' class='' checked data-unique-name="+l+" name='"+l+".Classifications[]'"+(F.Form?" form='"+F.Form.id+"'":"")+"></input><label  class='inline-block width-auto  text-yellow' for='chkx"+F.ClassificationInfo[0].value+"'>"+F.ClassificationInfo[0].text+"</label></div>";else for(var v=0;v<F.ClassificationInfo.length;v++){f+="<div class='col-6 overflow-hidden'><input id='chkx"+F.ClassificationInfo[v].value+"' value='"+F.ClassificationInfo[v].value+"' type='checkbox' class='' data-unique-name="+l+" name='"+l+".Classifications[]'"+(F.Form?" form='"+F.Form.id+"'":"")+"></input><label  class='inline-block width-auto  text-yellow' for='chkx"+F.ClassificationInfo[v].value+"'>"+F.ClassificationInfo[v].text+"</label></div>"}r.innerHTML=d+u+m+h+"<hr/>"+f;var p=document.createElement("button");p.className="btn text-strong  margin-top _idClickRemove",p.innerText="CLICK ĐỂ XÓA",p.type="button",p.dataset.file=e.currentTarget.FileName,p.dataset.notClose="I",p.addEventListener("click",function(e){F.RemoveFile(e,F.InputElement)}),r.append(p);var C="<img class='width-100 _max-width-100-percent' src='"+e.target.result+"' alt='"+g.name+"' data-file='"+g.name+"' /><figcaption class='padding-5 text-center _text-ellipsis'>("+g.size%1e3+" kb) "+g.name+"</figcaption>";F.IsCreateInputName&&(C+="<input type='text' class='_hidden' name='NewFiles"+F.UniqueControlName+"[]' value="+g.name+(F.Form?" form='"+F.Form.id+"'":"")+"></input>");o.innerHTML=C,o.insertBefore(r,o.childNodes[0]),s.appendChild(o),F.PreviewBoxElement.appendChild(s)},n.readAsDataURL(g)}}F.InputChangeCallBack&&F.InputChangeCallBack(F.StoredFiles)},this.RemoveCurentFile=function(e){for(var t=e.target.dataset.file,i=0;i<this.CurentFiles.length;i++)if(this.CurentFiles[i]===t){this.CurentFiles.splice(i,1);break}Site.FindParent(e.target,"_p-item").querySelector("[data-image-show]").remove()},this.RemoveFile=function(e,t){this.StoredFiles=[],this.PreviewBoxElement.innerHTML="",Site.ClearInputFile(t)},this.Init=function(e,t,i,a,n,l,s,o,r,c,d,u,m,h,f,v,p){var C=document.querySelector(l),F=document.querySelector(o),g=document.querySelector(s),I=document.querySelector(r);null!=C&&null!=F||console.warn(l+" or "+F+": NULL"),this.Extend(e,t,i,a,n,C,g,F,I,c,d,u,m,h,f,"true"==v||"True"==v,"true"==p||"True"==p)}}