"use strict";function FileUpload(){this.InputElement=null,this.PreviewBoxElement=null,this.CurentImageBox=null,this.Form=null,this.MaxFile=null,this.StoredFiles=[],this.CurentFiles=[],this.CurentPreviewImages=[],this.Extend=function(e,t,a,n,r,i,l,o,s,c,u){this.InputElement=n,this.PreviewBoxElement=i,this.CurentImageBox=r,this.Form=l,this.UniqueControlName=u||"CurentFilePaths[]",this.MaxFile=o||2,this.InputChangeCallBack=void 0!==s?s:null,this.InputElement.addEventListener("change",this.InputChange),(this.InputElement.fileUpload=this).FileReader=new FileReader,this.IsCreateInputName=c||!1,this.HostCdn=e||"",this.CurentFiles=t||[],this.CurentPreviewImages=a||[],this.Process()},this.Process=function(){if(this.CurentImageBox)for(var t=this,e=0;e<this.CurentFiles.length;e++){var a=this.CurentFiles[e],n=this.CurentPreviewImages[e],r=document.createElement("div");r.className="col-3 gutter-10 _p-item";var i=document.createElement("figure");i.className="_max-height-200 relative hover-children-show";var l=document.createElement("button");l.className="absolute hide tablet-show -border width-100 height-100 _fill-silver-opacity text-strong",l.innerText="CLICK ĐỂ XÓA",l.type="button",l.dataset.file=a,l.dataset.notClose="I",l.addEventListener("click",function(e){t.RemoveCurentFile(e,t.InputElement)});var o=a.substring(a.lastIndexOf("/")+1),s="<img class='_max-width-100-percent' onerror='this.src=\"/images/shared/no-image.svg\"' src='"+t.HostCdn+n+"' alt='"+o+"' data-file='"+o+"' /><figcaption class='padding-5 text-center _text-ellipsis'>"+o+"</figcaption>";if(t.IsCreateInputName)s+="<input type='text' class='_hidden' name='"+t.UniqueControlName+"' value="+a+(t.Form?" form='"+t.Form.id+"'":"")+"></input>";i.innerHTML=s,i.insertBefore(l,i.childNodes[0]),r.appendChild(i),t.CurentImageBox.appendChild(r)}},this.InputChange=function(e){var l=e.target.fileUpload,t=e.target.files,a=Array.prototype.slice.call(t);l.PreviewBoxElement.innerHTML="",l.StoredFiles=[],a.forEach(function(i){if(i.type.match("image.*")&&(l.StoredFiles.push(i),l.PreviewBoxElement===l.CurentImageBox&&(l.CurentFiles=[],l.CurentImageBox.innerHTML=""),l.StoredFiles.length+l.CurentFiles.length<=l.MaxFile)){var e=new FileReader;e.onload=function(e){var t=document.createElement("div");t.className="gutter-10 _p-item";var a=document.createElement("figure");a.className="_max-height-200 relative hover-children-show";var n=document.createElement("button");n.className="absolute hide -border width-100 height-100 _fill-silver-opacity text-strong",n.type="button",n.innerText="CLICK ĐỂ XÓA",n.dataset.file=i.name,n.dataset.notClose="I",n.addEventListener("click",function(e){l.RemoveFile(e,l.InputElement)});var r="<img class='width-100 _max-width-100-percent' src='"+e.target.result+"' alt='"+i.name+"' data-file='"+i.name+"' /><figcaption class='padding-5 text-center _text-ellipsis'>("+i.size%1e3+" kb) "+i.name+"</figcaption>";l.IsCreateInputName&&(r+="<input type='text' class='_hidden' name='NewFiles"+l.UniqueControlName+"[]' value="+i.name+(l.Form?" form='"+l.Form.id+"'":"")+"></input>");a.innerHTML=r,a.insertBefore(n,a.childNodes[0]),t.appendChild(a),l.PreviewBoxElement.appendChild(t)},e.readAsDataURL(i)}}),l.InputChangeCallBack&&l.InputChangeCallBack(l.StoredFiles)},this.RemoveCurentFile=function(e){for(var t=e.target.dataset.file,a=0;a<this.CurentFiles.length;a++)if(this.CurentFiles[a]===t){this.CurentFiles.splice(a,1);break}Site.FindParent(e.target,"_p-item").remove()},this.RemoveFile=function(e,t){for(var a=e.target.dataset.file,n=0;n<this.StoredFiles.length;n++)if(this.StoredFiles[n].name===a){this.StoredFiles.splice(n,1);break}Site.FindParent(e.target,"_p-item").remove(),Site.ClearInputFile(t)},this.Init=function(e,t,a,n,r,i,l,o,s,c,u){var d=document.querySelector(n),m=document.querySelector(i),g=document.querySelector(r),h=document.querySelector(l);null!=d&&null!=m||console.warn(n+" or "+m+": NULL"),this.Extend(e,t,a,d,g,m,h,o,s,c,u)}}function TabPages(){this.Extend=function(e,t,a){var n=e.dataset.activeTabNumber;this.SelectedTabNumber=+n||-1,this.NavElement=e,this.Tabs=t,this.TabContains=a,this.Process()},this.Process=function(){for(var n=this,e=0;e<this.Tabs.length;e++)this.Tabs[e].addEventListener("click",function(e){if(e.currentTarget.dataset.tabUrl&&history.replaceState(null,null,e.currentTarget.dataset.tabUrl),n.SelectedTabNumber=+e.currentTarget.dataset.tab||-1,n.NavElement.dataset.activeTabNumber=n.SelectedTabNumber,Site.BeLazyRevalidate(),e.currentTarget.dataset.callback){for(var t=null,a=0;a<n.TabContains.length;a++)if(n.TabContains[a].dataset.tabContent===e.currentTarget.dataset.tab){t=n.TabContains[a];break}Site.GetFunction(e.currentTarget.dataset.callback,["tabNumber","tabContainerElement"]).apply(e.currentTarget,[n.SelectedTabNumber,t])}})},this.Init=function(e){var t=document.querySelector(e),a=t.parentNode.querySelectorAll("[data-tab]"),n=t.parentNode.querySelectorAll("[data-tab-content]");this.Extend(t,a,n)}}function TabPages(){this.Extend=function(e,t,a){var n=e.dataset.activeTabNumber;this.SelectedTabNumber=+n||-1,this.NavElement=e,this.Tabs=t,this.TabContains=a,this.Process()},this.Process=function(){for(var n=this,e=0;e<this.Tabs.length;e++)this.Tabs[e].addEventListener("click",function(e){if(e.currentTarget.dataset.tabUrl&&history.replaceState(null,null,e.currentTarget.dataset.tabUrl),n.SelectedTabNumber=+e.currentTarget.dataset.tab||-1,n.NavElement.dataset.activeTabNumber=n.SelectedTabNumber,Site.BeLazyRevalidate(),e.currentTarget.dataset.callback){for(var t=null,a=0;a<n.TabContains.length;a++)if(n.TabContains[a].dataset.tabContent===e.currentTarget.dataset.tab){t=n.TabContains[a];break}Site.GetFunction(e.currentTarget.dataset.callback,["tabNumber","tabContainerElement"]).apply(e.currentTarget,[n.SelectedTabNumber,t])}})},this.Init=function(e){var t=document.querySelector(e),a=t.parentNode.querySelectorAll("[data-tab]"),n=t.parentNode.querySelectorAll("[data-tab-content]");this.Extend(t,a,n)}}var fileLogoUrl,fileLogo2Url,fileUploadFaviconFileUpload,fileUploadWartermarkImage,fileUploadWartermarkImageEcomerce,fileUploadLogo,fileUploadLogo2,fileUploadFavicon,fileWartermarkImage,fileWartermarkImageEcommerce,tabs,txtStaticPage,addNewButtoncontainer,frmUpdateStaticPage;function InitConfigIndex(){fileLogoUrl=document.getElementById("fileLogoUrl"),fileLogo2Url=document.getElementById("fileLogo2Url"),fileUploadFavicon=document.getElementById("fileUploadFaviconImage"),fileWartermarkImage=document.getElementById("fileWartermarkImage"),fileWartermarkImageEcommerce=document.getElementById("fileUploadWartermarkImageEcommerce"),txtStaticPage=document.getElementById("txtNewStaticPage"),addNewButtoncontainer=document.getElementById("addNewButtoncontainer"),frmUpdateStaticPage=document.getElementById("frmUpdateStaticPage")}function InitCleaves(){new Cleave("#ConfigJsonValuesModel_OpensHouse",{time:!0,timePattern:["h","m"]}),new Cleave("#ConfigJsonValuesModel_ClosesHouse",{time:!0,timePattern:["h","m"]})}function innitFileUpload(){if(null!==fileLogoUrl){var e=fileLogoUrl.dataset.curentPathFiles&&""!==fileLogoUrl.dataset.curentPathFiles?[fileLogoUrl.dataset.curentPathFiles]:null,t=fileLogoUrl.dataset.curentShowingImages&&""!==fileLogoUrl.dataset.curentShowingImages?[fileLogoUrl.dataset.curentShowingImages]:null;(fileUploadLogo=new FileUpload).Init(null,e,t,"#"+fileLogoUrl.id,"#curentFileReview","#curentFileReview","#frmLogo",1,console.log("change"),!0,"curentLogoUrl")}if(null!==fileLogo2Url){var a=fileLogo2Url.dataset.curentPathFiles&&""!==fileLogo2Url.dataset.curentPathFiles?[fileLogo2Url.dataset.curentPathFiles]:null,n=fileLogo2Url.dataset.curentShowingImages&&""!==fileLogo2Url.dataset.curentShowingImages?[fileLogo2Url.dataset.curentShowingImages]:null;(fileUploadLogo2=new FileUpload).Init(null,a,n,"#"+fileLogo2Url.id,"#curentFileReview2","#curentFileReview2","#frmLogo2",1,console.log("change"),!0,"curentLogo2Url")}if(null!==fileUploadFavicon){var r=fileUploadFavicon.dataset.curentPathFiles&&""!==fileUploadFavicon.dataset.curentPathFiles?[fileUploadFavicon.dataset.curentPathFiles]:null,i=fileUploadFavicon.dataset.curentShowingImages&&""!==fileUploadFavicon.dataset.curentShowingImages?[fileUploadFavicon.dataset.curentShowingImages]:null;(fileUploadFaviconFileUpload=new FileUpload).Init(null,r,i,"#"+fileUploadFavicon.id,"#curentFileReview1","#curentFileReview1","#frmFavicon",1,console.log("change"),!0,"curentUrl")}if(null!==fileWartermarkImage){var l=fileWartermarkImage.dataset.curentPathFiles&&""!==fileWartermarkImage.dataset.curentPathFiles?[fileWartermarkImage.dataset.curentPathFiles]:null,o=fileWartermarkImage.dataset.curentShowingImages&&""!==fileWartermarkImage.dataset.curentShowingImages?[fileWartermarkImage.dataset.curentShowingImages]:null;(fileUploadWartermarkImage=new FileUpload).Init(null,l,o,"#"+fileWartermarkImage.id,"#newFileReview2","#newFileReview2","#frmWartermark",1,console.log("change"),!0,"curentUrl")}if(null!==fileWartermarkImageEcommerce){var s=fileWartermarkImageEcommerce.dataset.curentPathFiles&&""!==fileWartermarkImageEcommerce.dataset.curentPathFiles?[fileWartermarkImageEcommerce.dataset.curentPathFiles]:null,c=fileWartermarkImageEcommerce.dataset.curentShowingImages&&""!==fileWartermarkImageEcommerce.dataset.curentShowingImages?[fileWartermarkImageEcommerce.dataset.curentShowingImages]:null;(fileUploadWartermarkImageEcomerce=new FileUpload).Init(null,s,c,"#"+fileWartermarkImageEcommerce.id,"#newFileReviewEcomerce","#newFileReviewEcomerce","#frmWartermark2",1,console.log("change"),!0,"curentUrl")}}function addStaticPages(){var e=document.getElementById("txtNewStaticPage"),t=document.createElement("div");t.className="row gutter-10  -padding-bottom -tablet-gutter-h",t.innerHTML="<input data-page name='StaticPages[]' value='/"+e.value+"' />",frmUpdateStaticPage.insertBefore(t,addNewButtoncontainer),reloadOrder()}function reloadOrder(){for(var e=document.querySelectorAll("[data-page]"),t=0;t<e.length;t++)e[t].name="StaticPages["+t+"]"}!function(s){var i="unobtrusiveAjaxClick",l="unobtrusiveAjaxClickTarget";function c(e,t){for(var a=window,n=(e||"").split(".");a&&n.length;)a=a[n.shift()];return"function"==typeof a?a:(t.push(e),Function.constructor.apply(null,t))}function u(e){return"GET"===e||"POST"===e}function o(l,e){var t,r,i,o;if(!(t=l.getAttribute("data-ajax-confirm"))||window.confirm(t)){r=s(l.getAttribute("data-ajax-loading")),o=parseInt(l.getAttribute("data-ajax-loading-duration"),10)||0,s.extend(e,{type:l.getAttribute("data-ajax-method")||void 0,url:l.getAttribute("data-ajax-url")||void 0,cache:"true"===(l.getAttribute("data-ajax-cache")||"").toLowerCase(),beforeSend:function(e){var t,a,n;return a=e,u(n=i)||a.setRequestHeader("X-HTTP-Method-Override",n),!1!==(t=c(l.getAttribute("data-ajax-begin"),["xhr"]).apply(l,arguments))&&r.show(o),t},complete:function(){r.hide(o),c(l.getAttribute("data-ajax-complete"),["xhr","status"]).apply(l,arguments)},success:function(e,t,a){var n,r,i;n=l,r=e,-1===(a.getResponseHeader("Content-Type")||"text/html").indexOf("application/x-javascript")&&(i=(n.getAttribute("data-ajax-mode")||"").toUpperCase(),s(n.getAttribute("data-ajax-update")).each(function(e,t){switch(i){case"BEFORE":s(t).prepend(r);break;case"AFTER":s(t).append(r);break;case"REPLACE-WITH":s(t).replaceWith(r);break;default:s(t).html(r)}})),c(l.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(l,arguments)},error:function(){c(l.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(l,arguments)}}),e.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),i=e.type.toUpperCase(),e.data instanceof FormData?(e.processData=!1,e.contentType=!1,e.data.append("X-Requested-With","XMLHttpRequest"),u(i)||(e.type="POST",e.data.append("X-HTTP-Method-Override",i))):(e.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),u(i)||(e.type="POST",e.data.push({name:"X-HTTP-Method-Override",value:i})));var a=s(l);if(a.is("form")&&"multipart/form-data"==a.attr("enctype")){var n=new FormData;s.each(e.data,function(e,t){n.append(t.name,t.value)}),s("input[type=file]",a).each(function(){var a=this;s.each(a.files,function(e,t){n.append(a.name,t)})}),s.extend(e,{processData:!1,contentType:!1,data:n})}s.ajax(e)}}s(document).on("click","a[data-ajax=true]",function(e){e.preventDefault(),o(this,{url:this.href,type:"GET",data:[]})}),s(document).on("click","form[data-ajax=true] input[type=image]",function(e){var t=e.target.name,a=s(e.target),n=s(a.parents("form")[0]),r=a.offset();n.data(i,[{name:t+".x",value:Math.round(e.pageX-r.left)},{name:t+".y",value:Math.round(e.pageY-r.top)}]),setTimeout(function(){n.removeData(i)},0)}),s(document).on("click","form[data-ajax=true] :submit",function(e){var t=e.currentTarget.name,a=s(e.target),n=s(a.parents("form")[0]);n.data(i,t?[{name:t,value:e.currentTarget.value}]:[]),n.data(l,a),setTimeout(function(){n.removeData(i),n.removeData(l)},0)}),s(document).on("submit","form[data-ajax=true]",function(e){var t,a=s(this).data(i)||[],n=s(this).data(l),r=n&&n.hasClass("cancel");(e.preventDefault(),r||(!(t=s(this).data("unobtrusiveValidation"))||!t.validate||t.validate()))&&(this.enctype&&"multipart/form-data"===this.enctype?new FormData(this):a.concat(s(this).serializeArray()),o(this,{url:this.action,type:this.method||"GET",data:a.concat(s(this).serializeArray())}))})}(jQuery),document.addEventListener("DOMContentLoaded",function(){InitConfigIndex(),innitFileUpload(),InitCleaves(),(tabs=new TabPages).Init("[data-active-tab-number]"),tabs.Tabs[tabs.SelectedTabNumber-1].click(),reloadOrder(),Site.BindingSelectAutoSubmit()});